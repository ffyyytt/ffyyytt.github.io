<!DOCTYPE html>
<html style="font-size: 16px;" lang="en-VN"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="ffyytt">
    <meta name="description" content="European Cyber Week(ECW) CTF 2023">
    <title>ECW2023</title>
    <link rel="stylesheet" href="../../../nicepage.css" media="screen">
<link rel="stylesheet" href="ECW2023.css" media="screen">
    <script class="u-script" type="text/javascript" src="../../../jquery.js" defer=""></script>
    <script class="u-script" type="text/javascript" src="../../../nicepage.js" defer=""></script>
    <meta name="generator" content="Nicepage 5.21.3, nicepage.com">
    <link rel="canonical" href="ffyyytt.github.io/IS/CTF/2023/ECW2023.html">
    <link rel="icon" href="../../../images/DAK1.png">
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": "ffyyytt_IS",
		"url": "ffyyytt.github.io/IS/CTF/2023/ECW2023.html",
		"logo": "../../../images/DAK1.png"
}</script>
    <meta name="theme-color" content="#478ac9">
    <meta property="og:title" content="ECW2023">
    <meta property="og:description" content="European Cyber Week(ECW) CTF 2023">
    <meta property="og:url" content="ffyyytt.github.io/IS/CTF/2023/ECW2023.html">
    <meta property="og:type" content="website">
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-HPSRH3EZQZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HPSRH3EZQZ');
</script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/themes/prism.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/plugins/line-numbers/prism-line-numbers.min.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/plugins/line-numbers/prism-line-numbers.min.js"></script><meta data-intl-tel-input-cdn-path="intlTelInput/"></head>
  <body data-path-to-root="../../../" data-include-products="false" class="u-body u-xl-mode" data-lang="en"><header class="u-clearfix u-header u-header" id="sec-b931"><div class="u-clearfix u-sheet u-sheet-1">
        <a href="https://ffyyytt.github.io/" class="u-image u-logo u-image-1" title="Home" data-image-width="251" data-image-height="251">
          <img src="../../../images/DAK1.png" class="u-logo-image u-logo-image-1">
        </a>
        <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
          <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px;">
            <a class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="#">
              <svg class="u-svg-link" viewBox="0 0 24 24"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use></svg>
              <svg class="u-svg-content" version="1.1" id="menu-hamburger" viewBox="0 0 16 16" x="0px" y="0px" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"><g><rect y="1" width="16" height="2"></rect><rect y="7" width="16" height="2"></rect><rect y="13" width="16" height="2"></rect>
</g></svg>
            </a>
          </div>
          <div class="u-custom-menu u-nav-container">
            <ul class="u-nav u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="https://ffyyytt.github.io/Home.html" style="padding: 10px 20px;">Home</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="https://ffyyytt.github.io/AI/Artificial-Intelligence.html" style="padding: 10px 20px;">Artificial Intelligence</a><div class="u-nav-popup"><ul class="u-h-spacing-20 u-nav u-unstyled u-v-spacing-10 u-nav-2"><li class="u-nav-item"><a class="u-button-style u-nav-link u-white" href="https://ffyyytt.github.io/AI/AI_papers/AI-papers.html">Papers</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-white" href="https://ffyyytt.github.io/AI/AI_competition/AI_competitions.html">Competitions</a>
</li></ul>
</div>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="https://ffyyytt.github.io/IS/Information-Security.html" style="padding: 10px 20px;">Information Security</a><div class="u-nav-popup"><ul class="u-h-spacing-20 u-nav u-unstyled u-v-spacing-10 u-nav-3"><li class="u-nav-item"><a class="u-button-style u-nav-link u-white" href="https://ffyyytt.github.io/IS/CTF/CTFs.html">CTFs</a>
</li></ul>
</div>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="https://ffyyytt.github.io/Projects.html" style="padding: 10px 20px;">Projects</a>
</li></ul>
          </div>
          <div class="u-custom-menu u-nav-container-collapse">
            <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
              <div class="u-inner-container-layout u-sidenav-overflow">
                <div class="u-menu-close"></div>
                <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-4"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="https://ffyyytt.github.io/Home.html">Home</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="https://ffyyytt.github.io/AI/Artificial-Intelligence.html">Artificial Intelligence</a><div class="u-nav-popup"><ul class="u-h-spacing-20 u-nav u-unstyled u-v-spacing-10 u-nav-5"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="https://ffyyytt.github.io/AI/AI_papers/AI-papers.html">Papers</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="https://ffyyytt.github.io/AI/AI_competition/AI_competitions.html">Competitions</a>
</li></ul>
</div>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="https://ffyyytt.github.io/IS/Information-Security.html">Information Security</a><div class="u-nav-popup"><ul class="u-h-spacing-20 u-nav u-unstyled u-v-spacing-10 u-nav-6"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="https://ffyyytt.github.io/IS/CTF/CTFs.html">CTFs</a>
</li></ul>
</div>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="https://ffyyytt.github.io/Projects.html">Projects</a>
</li></ul>
              </div>
            </div>
            <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
          </div>
        </nav>
      </div></header>
    <section class="u-clearfix u-section-1" id="sec-c801">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <img class="u-image u-image-default lazyload u-image-1" alt="" data-image-width="717" data-image-height="627" data-src="../../../images/ECW_scoreboard.png">
        <p class="u-text u-text-default u-text-1">7th student, 11th general</p>
      </div>
    </section>
    <section class="u-clearfix u-section-2" id="sec-253f">
      <div class="u-clearfix u-sheet u-valign-bottom u-sheet-1">
        <h2 class="u-text u-text-default u-text-1">Misc</h2>
      </div>
    </section>
    <section class="u-clearfix u-section-3" id="sec-6c5a">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <h3 class="u-text u-text-default u-text-1"> Jigsaw2 (1,2,3)</h3>
      </div>
    </section>
    <section class="u-clearfix u-section-4" id="sec-df41">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <h3 class="u-text u-text-default u-text-1"> FlyAway</h3>
        <p class="u-text u-text-default u-text-2"> Our Brittany antenna has intercepted this message. We think it contains major information. <a href="../../../files/mission.wav" class="u-active-none u-border-none u-btn u-button-link u-button-style u-file-link u-hover-none u-none u-text-palette-1-base u-btn-1">mission.wav</a>
        </p>
        <div class="u-clearfix u-custom-html u-expanded-width u-custom-html-1">
          <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/prism.min.js"></script>
          <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-python.min.js"></script>
          <pre><code class="language-python">from manchester_code import encode, decode, decode_bits
import numpy as np
import soundfile as sf
from Crypto.Util.number import *
data, samplerate = sf.read('mission.wav')
data = data.round().astype(int)
a = []
for i in range(len(data)//5):
    s = set(data[i*5: (i+1)*5])
    if -1 in s:
        a.append(0)
    else:
        a.append(1)
s = np.array(list(decode_bits(a))).astype(int)
print(long_to_bytes(int("".join(map(str, s.tolist())), 2))) </code></pre>
        </div>
        <p class="u-text u-text-default u-text-palette-2-base u-text-3"> Mayday, Mayday, We are flight EI-EMD. It is 10th January 2023. Be on time at (48.113,-1.571). The flag is ECW{HH:MM} with HH:MM the time in 24h format.</p>
        <p class="u-text u-text-default u-text-4">
          <a href="../../../files/FR5997_2ecd8ebf.csv" class="u-active-none u-border-none u-btn u-button-link u-button-style u-file-link u-hover-none u-none u-text-palette-1-base u-btn-2"> FR5997_2ecd8ebf.csv</a>
        </p>
        <p class="u-text u-text-default u-text-5">Flag: <span class="u-text-palette-2-base">ECW{06:36}</span>
        </p>
      </div>
    </section>
    <section class="u-clearfix u-section-5" id="sec-1040">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h3 class="u-text u-text-default u-text-1"> Babel</h3>
        <p class="u-text u-text-default u-text-2"> You found these two files in a dead drop. Decipher it. <a href="../../../files/ECW_Babel_unknown.txt" class="u-active-none u-border-none u-btn u-button-link u-button-style u-file-link u-hover-none u-none u-text-palette-1-base u-btn-1">unkown.txt</a>&nbsp;
        </p>
        <img class="u-image u-image-default lazyload u-image-1" alt="" data-image-width="711" data-image-height="777" data-src="../../../images/ECW_Babel_message.png">
        <p class="u-text u-text-default u-text-3">
          <a href="https://www.dcode.fr/symbols-ciphers" class="u-active-none u-border-none u-btn u-button-link u-button-style u-hover-none u-none u-text-palette-2-base u-btn-2"> https://www.dcode.fr/symbols-ciphers</a>
        </p>
      </div>
    </section>
    <section class="u-clearfix u-section-6" id="sec-a050">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <h2 class="u-text u-text-default u-text-1">Crypto</h2>
      </div>
    </section>
    <section class="u-clearfix u-section-7" id="sec-f89b">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <h3 class="u-text u-text-default u-text-1"> Random_key</h3>
        <p class="u-text u-text-default u-text-2"> An encrypted message sent by ALICE to its control center has been intercepted.<br>
          <br>You have managed to get your hands on some code snippets used by ALICE to encrypt its message, as well as the ciphertext. Your mission is to recover the message in clear text.<br>
          <br>Enc: 21952f9ced6c9109f8ce7c41cd3e0e6981c97a84745d5fdc75b2584e9a5a05e0
        </p>
        <p class="u-text u-text-default u-text-3">
          <a href="../../../files/ECW_Random_key.txt" class="u-active-none u-border-none u-btn u-button-link u-button-style u-file-link u-hover-none u-none u-text-palette-1-base u-btn-1">challenge.py</a>
        </p>
        <a href="../../../files/ECW_generate_key.c.txt" class="u-active-none u-border-none u-btn u-button-link u-button-style u-file-link u-hover-none u-none u-text-palette-1-base u-btn-2">geneate_key.c</a>
        <p class="u-text u-text-default u-text-palette-2-base u-text-4">Same random seed</p>
      </div>
    </section>
    <section class="u-clearfix u-section-8" id="sec-4bef">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h3 class="u-text u-text-default u-text-1"> BMPaaS</h3>
        <p class="u-text u-text-default u-text-2"> Just a baby encryption scheme for you. It features&nbsp;os.urandom, therefore it is perfectly safe.. <a href="../../../files/BMPaaS.txt" class="u-active-none u-border-none u-btn u-button-link u-button-style u-file-link u-hover-none u-none u-text-palette-1-base u-btn-1"> BMPaaS.py</a>
        </p>
        <div class="u-clearfix u-custom-html u-expanded-width u-custom-html-1">
          <pre><code class="language-python">import os
import base64
import numpy as np
from pwn import *
from tqdm.notebook import *
from collections import Counter
r = remote("instances.challenge-ecw.fr", 34646)
for i in trange(200000):
    r.recvuntil(b"Enter your choice: ")
    r.sendline(b"1")
    s = r.recvline()
    with open("file.txt", "ab") as f:
        f.write(s)
CHARSETD = base64._b85alphabet.decode()
CHARSET = {c: i for i, c in enumerate(CHARSETD)}
with open("file.txt", "r") as f:
    data = f.readlines()
idata = np.array([[CHARSET[c] for c in d[:-1]] for d in tqdm(data)])
s = list(s) 
s = ''.join(s)
with open("flag.bmp", "wb") as f:
    f.write(base64.b85decode(s)) </code></pre>
        </div>
        <img class="u-image u-image-default u-preserve-proportions lazyload u-image-1" alt="" data-image-width="107" data-image-height="5" data-src="../../../images/ECW_BMPaaS_flag.png">
      </div>
    </section>
    <section class="u-clearfix u-section-9" id="sec-9c52">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <h3 class="u-text u-text-default u-text-1"> CryptoFlow</h3>
        <p class="u-text u-text-default u-text-2"> You have misconfigured your IA who took the control of your computer. It's now mocking you using its favorite method: an unsolvable challenge. Find the password to take back the control of your system. <a href="../../../files/ECW_CryptoFlow.zip" class="u-active-none u-border-none u-btn u-button-link u-button-style u-file-link u-hover-none u-none u-text-palette-1-base u-btn-1">challenge.zip</a>
        </p>
        <p class="u-text u-text-default u-text-palette-2-base u-text-3">PWN SBox and do whatever you want.&nbsp;ECW{Whyd0yOuMod1fyMySb0xDude??!}.</p>
      </div>
    </section>
    <section class="u-clearfix u-section-10" id="sec-e9df">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <h3 class="u-text u-text-default u-text-1"> Straightline</h3>
        <p class="u-text u-text-default u-text-2"> You got access to a web site created by ALICE, the artificial intelligence. Your goal is to find an administrator access in order to obtain information to stop ALICE. To your disposal is the source of the cryptographic algorithm used for the authenfication. <a href="../../../files/ECW_Straightline.zip" class="u-active-none u-border-none u-btn u-button-link u-button-style u-file-link u-hover-none u-none u-text-palette-1-base u-btn-1">challenge.zip</a>
        </p>
        <p class="u-text u-text-default u-text-palette-2-base u-text-3">Request token for "admim" then calculate for "admin" its mapping 1:1.</p>
      </div>
    </section>
    <section class="u-clearfix u-section-11" id="sec-28cb">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <h2 class="u-text u-text-default u-text-1"> Reverse</h2>
      </div>
    </section>
    <section class="u-clearfix u-section-12" id="sec-c387">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <h3 class="u-text u-text-default u-text-1"> moth</h3>
        <p class="u-text u-text-default u-text-2"> Find the correct entry. <a href="../../../files/ECW_moth.zip" class="u-active-none u-border-none u-btn u-button-link u-button-style u-file-link u-hover-none u-none u-text-palette-1-base u-btn-1">challenge.zip</a>
        </p>
        <div class="u-clearfix u-custom-html u-expanded-width u-custom-html-1">
          <pre><code class="language-python">import sys
import copy
import numpy as np
s = [1, 2, 3, 4, 5]
a = [[1, 1, 1, 1, 2, 3, 3, 4, 5],
[6, 1, 7, 2, 2, 3, 4, 4, 5],
[6, 7, 7, 7, 2, 2, 8, 4, 5],
[6, 7, 9, 9, 9, 9, 8, 4, 5],
[6, 10, 9, 11, 11, 8, 8, 8, 13],
[10, 10, 10, 12, 11, 11, 14, 13, 13],
[10, 15, 15, 12, 11, 14, 14, 14, 13],
[16, 15, 15, 15, 18, 19, 19, 19, 13],
[16, 16, 17, 18, 18, 18, 18, 19, 19]]
d = {x: s[:np.array(a).flatten().tolist().count(x)] for x in range(20)}
a = np.array(a)
av = np.zeros_like(a)
def dequy(a, av, k, d):
    r = False
    if k == 81:
        print(av)
        return True
    i, j = (k//9), (k%9)
    for v in d[a[i, j]]:
        v4 = 0
        av[i, j] = v
        sys.stdout.flush()
        for n in range(-1, 2):
                for ii in range(-1, 2):
                    if (j + ii &gt;= 0 and i + n &gt;= 0 and j + ii &lt;= 8 and i + n &lt;= 8 and (ii != 0 or n != 0) and v == av[n + i, j + ii]):
                        v4 = 1
        if v4 == 0:
            d_new = copy.deepcopy(d)
            d_new[a[i, j]].remove(v)
            r = dequy(a, av, k+1, d_new)
        if not r:
            av[i, j] = 0
    return r
	
dequy(a, av, 0, d) </code></pre>
        </div>
      </div>
    </section>
    
    
    
    <footer class="u-align-center u-clearfix u-footer u-grey-80 u-footer" id="sec-d03e"><div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-small-text u-text u-text-variant u-text-1">Duong Anh Kiet</p>
      </div></footer>
    
  
</body></html>